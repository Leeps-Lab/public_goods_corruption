{{ extends "global/Page.html" }}

{{ block content }}
<script>
    function displayTextFuncionario() {
  var text = document.getElementById("textFieldFuncionario");
  text.style.display = "block";
}
    function displayTextCiudadano() {
  var text = document.getElementById("textFieldCiudadano");
  text.style.display = "block";
}
</script>
<style>
    /* Split the screen in half */
.split {
  height: 100%;
  width: 50%;
  position: fixed;
  z-index: 1;
  top: 0;
  overflow-x: auto;
  padding-top: 20px;
}

/* Control the left side */
.left {
  left: 0;
  border-right:1px solid black;
}

/* Control the right side */
.right {
  right: 0;
 
  border-left:1px solid black;
}

/* If you want the content centered horizontally and vertically */
.centered {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Style the image inside the centered container, if needed */
.centered img {
  width: 150px;
  border-radius: 50%;
}
</style>
<div class="split left">
    <div class="centered">

    <p>
        Tu rol es {{ player.role }}.
    </p>
    
    <p>
        Tienes 500 para distribuir entre tu cuenta y un proyecto común.
    </p>

    <table class="table">
        <tr>
            <th>Puntos a dar</th>
            <td id="my-proposal">(none)</td>
            <td>
                <input type="number" id="my_offer">
                <button type="button" onclick="sendOffer()" id="btn-offer">Enviar puntos</button>
            </td>
        </tr>
        <tr>
            <th>{{ role1 }} proposal</th>
            <td id="other-proposal1"></td>
        </tr>
        <tr>
            <th>{{ role2 }} proposal</th>
            <td id="other-proposal2"></td>
        </tr>
        <tr>
            <th>{{ role3 }} proposal</th>
            <td id="other-proposal3"></td>
        </tr>
    </table>
    

    <div id="textFieldFuncionario" style="display: none;">
        <p>
        Todos los ciudadanos contribuyeron --- puntos, los que se convirtieron en --- puntos. 
        </p>
        <p>
        La autoridad te distribuyó a ti -- puntos. 
        </p>
        <p>
            Tu pago de la ronda es de --- puntos. 
        </p>


    </div>
    <br><br>
{{ next_button }}

</div>

</div>

<div class="split right">

<table>
<tr>
{% for config in player.chat_configs %}
<th>
    <h6>{{ config.label }}</h6>
    {% chat nickname=player.chat_nickname channel=config.channel %}
</th>
{% endfor %}
</tr>
</table>

</div>


<style>
    .otree-chat{
        width: 250px
    }
    .otree-chat__messages {
        height: 300px;
        width: 230px
    }
    .otree-chat__input {
        width: 230px
    }

</style>

    <script>
    let my_offer= document.getElementById('my_offer');
    let msgMyProposal = document.getElementById('my-proposal');
    let msgOtherProposal1 = document.getElementById('other-proposal1');
    let msgOtherProposal2 = document.getElementById('other-proposal2');
    let msgOtherProposal3 = document.getElementById('other-proposal3');
    let otherProposal1;
    let otherProposal2;
    let otherProposal3;

    my_offer.addEventListener("keydown", function (event) {
        if (event.key === "Enter") {
            sendOffer();
        }
    });

    function sendOffer() {
        liveSend({ 'monto': my_offer.value })
        console.log('se envio')
    }
    function cu(monto) {
        return `${monto} puntos`;
    }

    function liveRecv(data) {
        console.log('received a message!', data);
        if ('proposals' in data){
            for (let [id_in_group, proposal] of data.proposals){
                if (id_in_group === js_vars.my_id){
                msgMyProposal.innerHTML = cu(proposal)
                }
            }
    }
}

    window.addEventListener('DOMContentLoaded', (event) => {
        liveSend({});
    });

    function displayTextCiudadano() {
  var text = document.getElementById("textFieldCiudadano");
  text.style.display = "block";
}



    </script>

    

{{ endblock }}
